<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

	<title>Code</title>
    
	<meta name="generator" content="Zim 0.62 & the Ecodiv-responsive template">
    <meta name="viewport" content="width=device-width, initial-scale=1">
	<link href='http://fonts.googleapis.com/css?family=Open+Sans:300&subset=latin,greek,latin-ext' rel='stylesheet' type='text/css'>
    <script type='text/javascript' src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-2.1.1.min.js"></script>
    <script type='text/javascript' src="../_resources/script.js" type="text/javascript"></script>
    <link rel="stylesheet" href="../_resources/style.css" type="text/css">
    <link rel="stylesheet" media="screen and (min-width: 1600px)" href="../_resources/style1.css" type="text/css">
    <link rel="stylesheet" media="screen and (max-width: 1600px) and (min-width:1000px)" href="../_resources/style2.css" type="text/css">
    <link rel="stylesheet" media="screen and (max-width: 999px) and (min-width:750px)" href="../_resources/style3.css" type="text/css">
    <link rel="stylesheet" media="screen and (max-width: 750px)" href="../_resources/style4.css" type="text/css">      
</head>
<body>    
	<div class="wrapper">
 
    <!--Collapsable menu-->    
        <div id="taskbar" style="color:#3D6E0F; font-weight:500;">
            <div id="menuicon">
                <a href="#" class="toggler" style="color:#CE5C00; text-decoration:none; line-height: 2em;"><img src="../_resources/menu.png" height="19" alt="Menu"></a> 
            </div>
            <div id="list">
                <div id="navigation">
                    <!-- To add additional links above the navigation menu, replace the link below with your link and remove comment tags
                    If you do, you may want to remove the extra line above the index -->
                    <!-- <p style="padding-left:20px; margin-bottom:0px"><a href="http://yourURL.html">Home</a></p> -->
                    <p></p>
                    <ul>
<li><a href="../Customize.html" title="Customize" class="page">Customize</a>
<ul>
<li><b>Code</b></li>
<li><a href="./Form.html" title="Form" class="page">Form</a></li>
<li><a href="./Guide.html" title="Guide" class="page">Guide</a></li>
<li><a href="./Query.html" title="Query" class="page">Query</a></li>
<li><a href="./Requirements.html" title="Requirements" class="page">Requirements</a></li>
<li><a href="./Tables.html" title="Tables" class="page">Tables</a></li>
</ul>
</li>
<li><a href="../Introduction.html" title="Introduction" class="page">Introduction</a></li>
<li><a href="../Set-up.html" title="Set-up" class="page">Set-up</a></li>
<li><a href="../Usage.html" title="Usage" class="page">Usage</a></li>
</ul>

                    <p></p>
                    <!-- Warning message if java script is disabled -->
                    <noscript>
                        <div style="padding: 10px">
                            <span style="color:#D48D8D"><p>Please note</p>
                            <p>To hide the menu</p>
                            <p>you need to enable</p>
                            <p>Java script</p></span>
                        </div>
                    </noscript>
                </div>
            </div>
        </div>
        <div id="block">
            <div id="content">
            
                <!-- You may want to replace the image below (but you are welcome to use it if you like) -->
                <img src="../_resources/header_1.png" width=100% alt="Header">
                <br>
                <h1>Code <a name='Home:Software:xTimeCard:Customize:Code'></a></h1>
                
                <p>
Created sabato 21 febbraio 2015
</p>

<p>
Software for database like Microsoft Access allows developers to customize via macro oriented programming language based on Visual Basic for Open/LibreOffice we use BASIC and function from the API called UNO. This is difficult for beginners therefore in this tutorial we reuse the knowledge previously developed programming Microsoft Access.
</p>

<h2>BASIC</h2>

<p>
LibreOffice Basic belongs to the family of Basic languages. Many parts of LibreOffice Basic are identical to Microsoft Visual Basic for Applications and Microsoft Visual Basic. Anyone who has already worked with these languages can quickly become accustomed to LibreOffice Basic.
</p>

<p>
You can also benefit from the advantages of object-oriented programming since an interface in LibreOffice Basic enables you to use external object libraries. LibreOffice Basic is an interpreter language.<br>
<img src="./Code/pasted_image.png">
</p>

<h3>Integrated Development Environment</h3>

<p>
Like most of modern and advanced programming languages, also Open/LibreOffice BASIC has a full featured environment or IDE which provides an editor for creating and testing macros, the interpreter (to run macros) and the interfaces to various Open/LibreOffice applications (direct access to Office documents). 
</p>

<h3>API and UNO</h3>

<p>
LibreOffice objects and methods, such as paragraphs, spreadsheets, and fonts, are accessible to LibreOffice Basic through the LibreOffice application programming interface, or API. Through the API, for example, documents can be created, opened, modified and printed. <br>
<img src="./Code/pasted_image001.png">
</p>

<p>
The API can be used not only by LibreOffice Basic, but also by other programming languages, such as Java and C++. The interface between the API and various programming languages is provided by something called Universal Network Objects (UNO).
</p>

<p>
Since LibreOffice Basic is a procedural programming language, several linguistic constructs have had to be added to it which enable the use of UNO.<br>
To use a Universal Network Object in LibreOffice Basic, you will need a variable declaration for the associated object. The declaration is made using the Dim instruction (see The Language of LibreOffice Basic). The Object type designation should be used to declare an object variable:<br>
<div style='padding-left: 30pt'>
<tt>Dim Obj As Object</tt>
</div>
The call declares an object variable named Obj.<br>
The object variable created must then be initialized so that it can be used. This can be done using the createUnoService function:<br>
<div style='padding-left: 30pt'>
<tt>Obj = createUnoService("com.sun.star.frame.Desktop")</tt>
</div>
This call assigns to the Obj variable a reference to the newly created object. com.sun.star.frame.Desktop resembles an object type; however in UNO terminology it is called a service rather than a type. In accordance with UNO philosophy, an Obj is described as a reference to an object which supports the<br>
<div style='padding-left: 30pt'>
<tt>com.sun.star.frame.Desktop</tt>
</div>
service. The service term used in LibreOffice Basic therefore corresponds to the type and class terms used in other programming languages.<br>
There is, however, one main difference: a Universal Network Object may support several services at the same time. Some UNO services in turn support other services so that, through one object, you are provided with a whole range of services. For example, that the aforementioned object, which is based on the<br>
<div style='padding-left: 30pt'>
<tt>com.sun.star.frame.Desktop</tt>
</div>
service, can also include other services for loading documents and for ending the program.
</p>

<h2>Access2Base</h2>

<p>
The extension <a href="http://www.access2base.com/access2base.html" title="Access2Base" class="http">Access2Base</a> already available from LibreOffice 4.2, may be started by adding few lines of BASIC code in the opening of every database file. This gives the advanced users and developers the ability to use a simplified language in the style of Microsoft Access to perform complex task without bothering oneself with UNO interface.
</p>

<h3>Activate API</h3>

<p>
To be able to invoke the Access2Base API from your database file ".odb", you have to add few lines of code from the BASIC IDE into the a module of your database file.<br>
<img src="./Code/pasted_image002.png">
</p>

<h4>DBOpen</h4>

<p>
Form menu  Tools → Macros → Organize Macros → Open/LibreOffice Basic add the macro “DBOpen” to your main module, if you never created one is the right moment to add “Module1” to your database file.
</p>
<pre style='padding-left: 30pt'>
Sub DBOpen(Optional poEvent As Object)
		If GlobalScope.BasicLibraries.hasByName("Access2Base") then _
				GlobalScope.BasicLibraries.LoadLibrary("Access2Base")
		Call Application.OpenConnection(ThisDatabaseDocument)
End Sub
</pre>

<p>
Create a module for your database application called for example “Module1” and edit to add the code; eventually you will end-up with a new macro called “DBOpen”.<br>
<img src="./Code/pasted_image003.png">
</p>

<p>
Assign in the main Base window with menu items Tools → Customize... (Events tab) the above Sub ("DBOpen" in the example but use the name of your choice) to the OpenDocument event. Save in the ".odb" file itself. <br>
<img src="./Code/pasted_image004.png"> <img src="./Code/pasted_image005.png">
</p>

<p>
Close and re-open your database file ".odb", this will trigger the OpenDocument event and start programming macro's with Access2Base dialect. <u>Repeat for every new file to activate Access2Base API</u>.
</p>

<h2>Test</h2>

<p>
Before creating cool things like a dashboard for our application or calculate values and update within the form, we need to check if the library works properly. For instance let's add the ability to launch a new form, copy “_test” into “....”.
</p>

                <br>
                <span class="backlinks">
                    <hr class='footnotes'>
                    <b>Backlinks:</b>
                    <br />
                    <a href='../Customize.html'>Home:Software:xTimeCard:Customize</a>
                    
                </span>
                
                <!-- !! The script will center all images. If you prefer the default (images at left delete these three lines -->    
                <script>
                    $( "img" ).wrap( "<div class='imgcenter'></div>" );
                </script>
                
                
            
                <div id='footer'>
                    <p>Created with <a href='http://zim-wiki.org/'>Zim-wiki</a> & the <a href='https://github.com/ecodiv/Ecodiv-responsive'>Ecodiv-responsive template</a><p>
                </div>
            </div>
        </div>
	</div>
</body>
</html>
